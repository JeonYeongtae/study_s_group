# Cookie

## 🍪 쿠키(Cookie)란?

**쿠키는 웹 서버가 사용자의 브라우저에 저장하는 작은 데이터 조각**으로, 사용자의 상태 정보를 유지하거나 추적하기 위해 사용된다.

사용자 정보를 저정한다는 것은 세션이나 쿠키나 같고 저장하는 장소의 차이

세션 - 서버, 쿠키 - 사용자의 브라우저(크롬, 웨일, Safari 등)

### 왜 이렇게 나눌까?

- **쿠키는 클라이언트에 저장돼서 용량이 작고 보안에 취약할 수 있음** → 중요한 데이터(비밀번호, 권한 등)를 직접 저장하면 위험함
- **세션은 서버에 저장돼서 상대적으로 안전** → 서버에서 중요한 사용자 정보를 관리하고, 클라이언트에는 세션 ID만 쿠키로 전달

### 예시 흐름

1. 사용자가 로그인 → 서버가 세션 생성 → 세션 ID를 쿠키로 사용자 브라우저에 저장
2. 이후 요청 시 브라우저가 쿠키(세션 ID)를 서버에 전송 → 서버가 세션 ID로 사용자 상태 확인
3. 로그인 상태 유지, 장바구니 정보 등은 서버 세션에 저장되어 관리됨

## ✅ 쿠키의 주요 특징

| 항목          | 설명                                                |
| ------------- | --------------------------------------------------- |
| **저장 위치** | 사용자의 **브라우저** (클라이언트 측)               |
| **형식**      | key=value 쌍의 문자열                               |
| **자동 전송** | 같은 도메인 요청 시 브라우저가 자동으로 서버에 전송 |
| **크기 제한** | 약 4KB (브라우저마다 다를 수 있음)                  |
| **만료 설정** | `Expires` 또는 `Max-Age`로 유효 기간 설정 가능      |

## 🧩 쿠키의 주요 사용 목적

1. **세션 유지**
   - 로그인 상태 유지
   - 장바구니 정보 저장 등
2. **사용자 식별**
   - 방문자 고유 ID를 저장하여 반복 방문 추적
3. **개인화된 환경 제공**
   - 언어 설정, 테마 저장 등 사용자 맞춤 설정
4. **광고 및 분석**
   - 제3자 쿠키를 이용한 광고 추적 및 사용자 분석

## 🛡️ 쿠키 속성

| 속성                  | 설명                                                                |
| --------------------- | ------------------------------------------------------------------- |
| `Expires` / `Max-Age` | 쿠키 만료 시점 (지정 안하면 세션 쿠키)                              |
| `Path`                | 쿠키를 전송할 URL 경로                                              |
| `Domain`              | 쿠키가 전송될 도메인 지정                                           |
| `Secure`              | HTTPS 연결에서만 쿠키 전송                                          |
| `HttpOnly`            | JavaScript에서 접근 불가 → XSS 방지                                 |
| `SameSite`            | 크로스 사이트 요청 시 쿠키 전송 여부 조절 - `Strict`, `Lax`, `None` |

## 🔒 쿠키와 보안

| 위협                                  | 설명 및 방지 방법                                                     |
| ------------------------------------- | --------------------------------------------------------------------- |
| **XSS** (Cross Site Scripting)        | 쿠키 탈취 가능 → `HttpOnly` 설정으로 방지                             |
| **CSRF** (Cross Site Request Forgery) | 사용자 쿠키를 악용한 요청 → `SameSite=Strict` 또는 CSRF 토큰으로 방지 |
| **도청 및 탈취**                      | HTTPS와 `Secure` 속성으로 암호화 필요                                 |

## 🍰 쿠키와 다른 저장 방식 비교

| 항목      | 쿠키            | 로컬 스토리지 | 세션 스토리지      |
| --------- | --------------- | ------------- | ------------------ |
| 저장 위치 | 브라우저        | 브라우저      | 브라우저           |
| 저장 크기 | 약 4KB          | 5MB 이상      | 5MB 이상           |
| 수동 전송 | ❌ 자동 전송    | ✅ 수동       | ✅ 수동            |
| 사용 예   | 인증, 상태 유지 | 캐시 데이터   | 일시적 데이터 저장 |

### 정리:

- **쿠키**: 사용자의 브라우저(클라이언트)에 저장되는 작은 데이터입니다.
  예를 들어, 사용자 이름, 로그인 토큰, 선호 설정 등 가벼운 정보를 저장할 수 있어요.
  쿠키는 사용자의 컴퓨터에 저장되고, 브라우저가 서버에 요청할 때마다 자동으로 함께 전송됩니다.
- **세션**: 서버에 저장되는 사용자 상태 정보입니다.
  사용자가 로그인하면, 서버는 고유한 세션 ID를 생성하고 이 세션 ID를 쿠키를 통해 사용자 브라우저에 전달합니다.
  서버는 세션 ID를 통해 각 사용자의 상태 정보를 관리합니다(예: 로그인 상태, 장바구니 내용 등).
