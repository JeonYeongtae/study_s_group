# 🥱 [ 2주차 l DB l JYT ]

Status: 진행 중
날짜: 2025/06/02
선택: 2주차
작성자: 전영태

# 3장. SQL

SQL의 기능에 따라 분류되는 명령어에서 

‘어디에 작용하느냐(=범위)와 무엇을 다루느냐(=의도)’를 파악하며 이해하는 것이 중요하다고 판단했다.

---

## **SQL 전체 구조 – “무엇을 건드리는가?”**

| **분류** | **전체 구조에 대한 감각** | **예시 비유** |
| --- | --- | --- |
| **DDL** (데이터 정의 언어) | **데이터가 담기는 그릇 자체를 만드는 일** | 집을 짓는 설계자. 테이블이라는 틀을 만든다. |
| **DML** (데이터 조작 언어) | **그릇 안에 있는 데이터를 넣고 빼는 일** | 그릇에 음식을 담고, 빼고, 바꾸는 요리사 역할 |
| **DCL** (데이터 제어 언어) | **그 그릇을 누가 쓰게 할지를 정하는 일** | 냉장고 자물쇠를 관리하는 사람. 권한과 보안을 다룬다. |

---

## **1. DDL – 데이터 정의 언어 (Definition)**

> “데이터가 들어갈 공간(구조)을 만드는 언어”
> 

### **핵심 개념:**

- 테이블 자체를 만들거나 삭제하거나 변경할 때 사용
- 테이블 스키마(구조)를 건드리는 명령어

### **대표 명령어:**

- CREATE: 테이블이나 데이터베이스 생성
- ALTER: 테이블 구조 수정
- DROP: 테이블 또는 데이터베이스 삭제
- TRUNCATE: 테이블 내 데이터 전체 삭제 (구조는 유지)

### **포인트:**

- **데이터 자체가 아니라 그 ‘틀’을 다룬다**
- 실행하면 데이터베이스 구조가 직접 바뀜 → 일반적으로 **자동 커밋된다**

---

## **2. DML – 데이터 조작 언어 (Manipulation)**

> “정의된 테이블 안에서 데이터를 다루는 언어”
> 

### **핵심 개념:**

- 테이블 안의 데이터를 추가하거나 수정, 삭제, 조회할 때 사용
- 실제 서비스에서 가장 많이 사용되는 영역

### **대표 명령어:**

- SELECT: 데이터 조회
- INSERT: 데이터 추가
- UPDATE: 데이터 수정
- DELETE: 데이터 삭제

### **포인트:**

- **테이블의 구조는 건드리지 않음** (형태는 그대로)
- 데이터만 바꾸므로 트랜잭션 처리가 필요함 → **COMMIT / ROLLBACK 가능**

---

## **3. DCL – 데이터 제어 언어 (Control)**

> “누가 데이터를 다룰 수 있을지 통제하는 언어”
> 

### **핵심 개념:**

- 보안과 접근 권한에 대한 설정
- 사용자의 권한을 주거나 회수한다

### **대표 명령어:**

- GRANT: 특정 사용자에게 권한 부여
- REVOKE: 권한 회수

### **포인트:**

- **시스템의 데이터 접근 통제를 위한 장치**
- 관리자의 권한 설정에 주로 쓰인다

---

## **3가지 SQL구분 요약**

| **항목** | **다루는 대상** | **구조/데이터/권한** | **예시** |
| --- | --- | --- | --- |
| **DDL** | 테이블/데이터베이스 | 구조 (그릇 만들기) | CREATE, DROP |
| **DML** | 테이블 내부의 데이터 | 데이터 (그릇 속 내용) | SELECT, INSERT |
| **DCL** | 사용자와 권한 | 접근 제어 (그릇 잠금) | GRANT, REVOKE |

---

## **왜 이 구분이 중요한가?**

1. **SQL 문장을 쓰는 목적이 다 다르기 때문이다.**
    - “구조를 만들 건가?” → DDL
    - “내용을 조작할 건가?” → DML
    - “접근 권한을 설정할 건가?” → DCL
2. **실행 결과의 특성이 다르다.**
    - DDL은 **바로 반영된다** (자동 커밋)
    - DML은 **트랜잭션으로 묶어서** 처리 가능
    - DCL은 **보안과 연계되어** 시스템 운영에 영향

---

# 4장. 효율적 쿼리 – 성능과 구조를 고려한 SQL 설계

데이터의 양이 많아질수록 단순히 데이터를 조회하는 것만으로는 충분하지 않다. 

**빠르게**, **정확하게**, **부하를 줄이면서** 데이터를 가져오려면 효율적인 쿼리 설계가 필수다. 

---

## 서브쿼리 (Subquery)

서브쿼리는 **쿼리 안에 또 다른 쿼리를 포함**시키는 방식이다. 주로 WHERE절이나 SELECT절 내부에서 사용되며, 복잡한 조건을 처리할 때 유용하다.

- **예시**: “가장 높은 급여를 받는 사원의 이름을 구하라”

```
SELECT name FROM employees
WHERE salary = (SELECT MAX(salary) FROM employees);
```

- **종류**
    - 스칼라 서브쿼리: 하나의 값만 반환
    - 다중행 서브쿼리: 여러 값을 반환 (IN, ANY, ALL 등과 함께 사용)
    - 상관 서브쿼리: 외부 쿼리의 값을 참조하며 반복 실행된다
- **서브쿼리 vs 조인 차이점**
    - 서브쿼리는 **값 기반 비교**, 조인은 **행 병합** 방식
    - 조인이 **더 빠르고 직관적**인 경우가 많다

## 조인 (Join)

조인은 **둘 이상의 테이블을 연결**해서 데이터를 가져오는 방식이다. 테이블 간 관계를 기반으로 데이터를 병합하며, 관계형 데이터베이스의 핵심 기능이다.

- **종류**
    - **INNER JOIN**: 양쪽 테이블에서 일치하는 데이터만 출력
    - **LEFT OUTER JOIN**: 왼쪽 테이블 기준 + 일치하지 않는 오른쪽은 NULL
    - **RIGHT OUTER JOIN**: 오른쪽 테이블 기준 + 일치하지 않는 왼쪽은 NULL
    - **FULL OUTER JOIN**: 양쪽 테이블 모두 기준으로, 일치하지 않으면 NULL
    - **SELF JOIN**: 같은 테이블을 두 번 참조할 때 사용
- **왜 중요한가?**
    
    테이블을 나누어 설계했기 때문에, 실제 데이터를 분석하려면 **조인 없이는 정보가 완성되지 않는다**
    

## UNION (합집합)

UNION은 **여러 SELECT 결과를 위에서 아래로 합치는 방식이**다. 테이블이 달라도 컬럼 수와 타입이 같으면 가능하며, **수직 결합**이라고 생각하면 된다.

- UNION: 중복 제거 O
- UNION ALL: 중복 제거 X
- **주의점**: 컬럼 개수와 타입이 동일해야 한다
- **활용 예시**: 삭제된 회원 테이블과 기존 회원 테이블을 합쳐 전체 회원 목록 만들기

## 뷰 (View)

뷰는 **SELECT 쿼리를 저장해두는 가상 테이블이**다. 실제 데이터를 저장하진 않지만, 복잡한 쿼리를 단순하게 사용할 수 있게 해준다.

- **장점**
    - 보안: 중요한 컬럼은 뷰에서 제외 가능
    - 재사용성: 자주 사용하는 쿼리를 반복 작성하지 않아도 된다
    - 논리적 독립성: 원본 테이블 변경 시에도 뷰 유지 가능
- **예시**: 급여 5000 이상인 직원 뷰 생성

```
CREATE VIEW high_salary_employees AS
SELECT name, department FROM employees WHERE salary >= 5000;
```

## 인덱스 (Index)

인덱스는 **데이터베이스에서 검색 속도를 향상시키는 자료구조이**다. 책의 목차처럼, 원하는 데이터를 빨리 찾기 위한 기술이다.

- **클러스터형 인덱스 (Clustered Index)**
    - 테이블 자체가 인덱스에 의해 정렬된다 (한 테이블에 하나만 가능)
    - PK가 보통 클러스터 인덱스로 자동 지정된다
- **비클러스터형 인덱스 (Non-Clustered Index)**
    - 테이블 데이터와는 별개로 인덱스가 따로 존재
    - 하나의 테이블에 여러 개 생성 가능
- **자료구조 기반**
    - 대부분의 인덱스는 **B-Tree** 구조를 기반으로 구현된다
    - 데이터 분기와 정렬을 통해 탐색 시간 단축
- **주의점**
    - 인덱스가 너무 많으면 오히려 **쓰기 성능이 저하된다**
    - 조건절에 자주 쓰이는 컬럼에 인덱스를 설정하는 것이 좋다